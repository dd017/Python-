import os
from datetime import datetime

FILE_NAME = "diary.txt"

def display_menu():
    print("\n--- Personal Diary ---")
    print("1. Add Entry")
    print("2. View Entries")
    print("3. Edit Entry")
    print("4. Delete Entry")
    print("5. Search Entries")
    print("6. Exit")

def add_entry():
    with open(FILE_NAME, 'a') as file:
        date_str = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        entry = input("Enter your diary entry: ")
        file.write(f"{date_str}\n{entry}\n\n")
        print("Entry added successfully.")

def view_entries():
    if os.path.exists(FILE_NAME):
        with open(FILE_NAME, 'r') as file:
            entries = file.read().strip()
            if entries:
                print("\n--- Diary Entries ---\n")
                print(entries)
            else:
                print("No entries found.")
    else:
        print("No entries found.")

def edit_entry():
    if not os.path.exists(FILE_NAME):
        print("No entries found.")
        return

    with open(FILE_NAME, 'r') as file:
        lines = file.readlines()

    print("\n--- Edit Entry ---\n")
    for i, line in enumerate(lines):
        if line.strip() and '-' in line:
            print(f"{i}: {line.strip()}")

    try:
        entry_index = int(input("Enter the line number of the entry date to edit: "))
        if 0 <= entry_index < len(lines) and '-' in lines[entry_index]:
            new_content = input("Enter the new content for the entry: ")
            lines[entry_index + 1] = f"{new_content}\n"
            with open(FILE_NAME, 'w') as file:
                file.writelines(lines)
            print("Entry updated successfully.")
        else:
            print("Invalid entry selection.")
    except ValueError:
        print("Invalid input. Please enter a valid line number.")

def delete_entry():
    if not os.path.exists(FILE_NAME):
        print("No entries found.")
        return

    with open(FILE_NAME, 'r') as file:
        lines = file.readlines()

    print("\n--- Delete Entry ---\n")
    for i, line in enumerate(lines):
        if line.strip() and '-' in line:
            print(f"{i}: {line.strip()}")

    try:
        entry_index = int(input("Enter the line number of the entry date to delete: "))
        if 0 <= entry_index < len(lines) and '-' in lines[entry_index]:
            del lines[entry_index:entry_index + 3]
            with open(FILE_NAME, 'w') as file:
                file.writelines(lines)
            print("Entry deleted successfully.")
        else:
            print("Invalid entry selection.")
    except ValueError:
        print("Invalid input. Please enter a valid line number.")

def search_entries():
    if not os.path.exists(FILE_NAME):
        print("No entries found.")
        return

    keyword = input("Enter keyword to search: ").strip()
    with open(FILE_NAME, 'r') as file:
        entries = file.read().strip()

    if keyword in entries:
        print("\n--- Search Results ---\n")
        print("\n".join(line for line in entries.split('\n') if keyword in line))
    else:
        print("No entries containing the keyword found.")

def main():
    while True:
        display_menu()
        choice = input("Enter your choice (1-6): ")

        if choice == '1':
            add_entry()
        elif choice == '2':
            view_entries()
        elif choice == '3':
            edit_entry()
        elif choice == '4':
            delete_entry()
        elif choice == '5':
            search_entries()
        elif choice == '6':
            print("Exiting the Personal Diary. Goodbye!")
            break
        else:
            print("Invalid choice. Please select a valid option.")

if __name__ == "__main__":
    main()
